### 保密等级

保密等级分为: 秘密, 机密, 绝密;

单位涉密信息分级保护分别不得低于 三, 四, 五级;

### 计算机系统安全等级

等级:
> D, C (C1, C2), B (B1, B2, B3), A

- D: 无防护 - DOS, win98;
- C:
  - C1: 选择性保护, 自主安全防护, 用户数据分离, 
  - C2: 在 C1 的基础上, 有访问控制环境的权力, 比 C1 的控制划分的更为详细;
- B:
  - B1: 标识安全保护级别: 强制性安全, 多级安全; 保持标记完整性, 拥有者也不具有更改自身的权限; 系统数据属于访问控制者(一个特殊管理员)的控制下;
  - B2: 结构保护级别: 要求访问控制的所有对象都有安全标签以实现低级别用户不能访问; 这个级别开始要考虑*屏蔽通道*;
  - B3: 安全域保护级别: 要求用安装硬件的方式加强域安全, 比如用内存管理**硬件**来防止无授权访问;
- A: 只有A1, 为验证设计级, 安全设计必须要严密的形式化设计和验证, 且有严格推导的数学证明过程; 还要有秘密信道和可信分布分析;

### 故障树分析法

故障树分析法, 强调溯源; 

- 顶事件：系统级失效（例如“发动机失效”）。
- 基本事件：原子故障（传感器故障、人为失误等）。
- 逻辑门：AND、OR 等，表示故障的组合逻辑。
- 常用于计算失效概率、确定关键元件（单点故障）。

优缺点和下面一样;

### 攻击树

攻击树分析法的简单举例理解:

将攻击最终目标作为根节点 (例如取得 root 权限), 中间叶是各个步骤或者需要取得的必要条件; 叶子结点是具体攻击或者前置条件;

这个模型中的常见关系是 `AND - OR` (全部满足和任一满足);

优点: 工程性强, 定量化强;

局限: 难建模, 结构比较复杂;

### MITRE ATT&CK 模型

一个以实战为基础的知识库/框架, 列出攻击者在不同攻击阶段使用的战术与技术, 并给出检测与防御对策建议。

关键词是**侧重对方行为而不是漏洞本身**

优点: 基于实战、分类详尽、社区维护且可量化覆盖率

缺点: 不是流程模型, 因为是基于行为的分析, 需要长期更新维护;

### 网络杀伤链

一种攻击方阶段推进线性叙事的模型; 典型例子:

> 侦察 → 武器化 → 交付 → 利用 → 安装 → 命令控制 C2 → 行动

优点: 流程化, 便于把防御点映射到不同阶段, 强调阻断和早期检测;

缺点: 线性假设比较理想, 对长期复杂的入侵刻画不足;

## 软件安全能力成熟度模型

软件安全能力成熟度模型分成五级，各级别的主要过程如下:
- CMMI级: 补丁修补;
- CMM2级: 渗透测试、安全代码评审;
- CMM3级: 漏洞评估、代码分析、安全编码标准;
- CMM4级: 软件安全风险识别、SDLC实施不同安全检查点;
- CMM5级: 改进软件安全风险覆盖率、评估安全差距。

<br>

## ACL 过滤规则

例如 `rule 5 deny 123.1.1.0 0.0.6.0`, 那么 `123.1.3.0` 会被拒绝;

```
IP: 123.1.1.0
掩码: 0.0.6.0
```

ACL 掩码中 0 检测, 1 不检测:

```
IP  = 00000001
Test= 00000011
Mask= 00000110

00000001 AND (NOT 00000110) = 00000001
00000011 AND (NOT 00000110) = 00000001
```

结果相同, 匹配成功, 因此拦截;

其实这个规则是有个规律的, 掩码中的中不为 0 的是可变位, 再加上 IP 中的固定值就是实际拦截范围; 这个示例中是 `1 3 5 7 9`;

## 易错点总结

1. 网络带宽和服务质量是无形资产, 而文档这些逻辑文件依然是有形资产;
2. 个人信息保护法是 21 年 11 月 1 日起开始实行的;
3. USENIX Security 是网安 A 类会议;
4. 大数据有数据价值密度低的特征这个说法是**正确**的;
5. 共识算法是区块链的基础而非大数据; 大数据不一定是去中心化的;
6. 文件加密不属于数据防泄漏;
7. P2DR 四要素: 策略, 防护, 检测, 响应, 注意没有恢复;
8. 数据库加密技术包括基于 **文件,记录,字段**, 原理:

> 表级加密对增删改查的牺牲过大了, 所以不行; 那为什么库级加密可以呢? 因为增删改查的时候实际上不是在加解密整库, 它的加密环节发生在 I/O 时的数据页, 所以库级加密实际上是数据页加密;

9. 堆栈结构的最底部是调用函数返回地址, 其上才是寄存器数据保留地址;
10. 基于状态的防火墙不会将检测有效的新数据包加入会话表, 这一点需要和路由表区分; 这一点可以从模型上快速理解, 会话表是上层对下层的控制, 需要**满足上层的指定授权**才可以, 如果检测到网络层的数据包有效就要更新的话, 那么就变成了下层对上层的反馈, 用在这里显然是不规范的;
11. - 安全事件可能性: $\sqrt(威胁发生频率 * 脆弱性)$
    - 损失: $\sqrt(资产价值*脆弱性)$
    - 风险值: $损失 * 可能性$;

12. 中华人民共和国密码法 2020 年 1月 1日起;
13. 中央网络信息化安全小组成立于 2014 年 2 月 27 日, 2018 年 3 月改组为中央网络安全和信息化委员会;
14. 中华人民共和国数据安全法于 2021 年 6 月 10 日通过, 9 月 1日开始实行;


## 密码学数学基础

### 平方剩余

简单来说, 如果

$$y^2=f(x) \space mod \space p$$

那么也就是 $y^2-f(x) = kp$, $k \in Z$

### S/key

客户端生成, 服务器验证, 用于验证后面的消息是不是前面那个用户生成的

#### 协商阶段

用户和服务器协定:

- 哈希算法 $H$
- 盐值/噪音 $r$ (Salt)
- 链长度 $N$;
- 初始值 $P$, 注意这个值只在客户端本地储存;

之后客户端本地计算 $S_N=H^N{(P+r)}$ 并发送给服务器

#### 第一次验证

客户端计算 $i=N-1$ 的 hash 值:

$$S_{N-1}=H^{N-1}{(P+r)}$$

然后发送给服务器, 服务器接收到后再进行一轮哈希计算, 如果和本底值相等:

$$H(S_{i})=H(S_{N-1})=S_N$$

则验证通过, 同时更新本地存储的值由 $S_N$ 变为 $S_{N-1}$;

之后重复这个迭代过程即可;

#### 安全性

属于状态推进型认证; (协商-认证)

由哈希函数的单向性保证;

如果用户在应该传 $S_i$ 的轮次误传了 $S_{i-4}$, 一般来说服务器会有容错考虑多计算两次哈希, 但是这个容错也有上限, 一方面防止网络波动引起断开连接, 另一方面计算太多次可能容易被 DoS 攻击;

由于服务器永远不会知道或者接收到初始值 $P$, 而哈希函数是单向的, 因此服务器到用户端之间信道的所有数据即使都被窃听, 也无法伪造未来的 $S_i$;

### IDEA

IDEA = 分组加密 + 128 位密钥 + 混合算术运算结构 + 高抗破解性

### 针对 DDoS 的防护

三部分:

- 流量检测,
- 流量牵引和清洗
- 流量回注

## 网安基础

Botnet
