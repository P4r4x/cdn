
===

记一次 orcale 数据迁移, 预清洗文件到落地的过程;

## 前期准备

源数据表中的格式如下:



### 导入测试数据表

```bash
impdp 用户名/密码@数据库 \
    DIRECTORY=DATA_PUMP_DIR \
    DUMPFILE=test_imfile.dmp \
    TABLES=TEST_IMFILE \
    REMAP_SCHEMA=源用户名:目标用户名
```

impdp gic_1160@127.0.0.1/orcl DUMPFILE=test_imfile.dmp TABLES=TEST_IMFILE REMAP_SCHEMA=cqjw:gic_1160

impdp "gic_1160/ufgov@1234"@127.0.0.1:1521/orcl DIRECTORY=DATA_PUMP_DIR DUMPFILE=test_imfile.dmp TABLES=TEST_IMFILE REMAP_SCHEMA=cqjw:gic_1160

```sql
SELECT AUDIT_OPINION,BEAN_CODE,BEAN_ID,BEAN_TITLE,DEFINE_CODE,DEFINE_NAME,FUNC_CODE,GRADE_CODE,GRADE_NAME,JE_RISK_DEFINE_ID,JE_RISK_REGISTER_ID,LEVEL_CODE,LEVEL_ID,LEVEL_NAME,REMINDER_DATE,RESPONSIBLE_DEPTID,RESPONSIBLE_DEPTNAME,RESPONSIBLE_USERID,RESPONSIBLE_USERNAME,RISK_FILES,RISK_NO,RISK_NOTE,RISK_STATE_CODE,RISK_STATE_NAME,RISK_TITLE,SY_AUDFLAG,SY_CREATEORG,SY_CREATEORGID,SY_CREATEORGNAME,SY_CREATETIME,SY_CREATEUSER,SY_CREATEUSERID,SY_CREATEUSERNAME,SY_ENCRYPTION,SY_JTGSID,SY_JTGSMC,SY_ORDERINDEX,SY_PDID,SY_PIID,SY_STATUS FROM JE_RISK_REGISTER WHERE 1=1   AND RISK_STATE_CODE<>'2' and BEAN_ID='3CA1340FC1854071AA9F9C9AA8B6146D' order by GRADE_CODE ASC,LEVEL_CODE ASC,replace(RISK_NO,DEFINE_CODE,'') ASC
/file/childFuncFileAction!getFileBadge.action
```